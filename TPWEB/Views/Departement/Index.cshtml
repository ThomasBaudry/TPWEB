@using GestionCegepWeb.Logics.Controleurs
@using GestionCegepWeb.Models
@model DepartementDTO
@*Si erreur du côté serveur... affichage du message d'erreur...*@
<h3>Sélectionner un Cégep</h3>




@if (ViewBag.MessageErreur != null)
{
    <br />
    <h2 class="alert-danger">@ViewBag.MessageErreur</h2>
}
else
{
    ViewBag.ListeCegeps = CegepControleur.Instance.ObtenirListeCegep(); 
    <form asp-controller="Departement" asp-action="Index" method="get">
        <select name="nomCegep" onchange="submit();">
            @foreach(CegepDTO cegep in ViewBag.ListeCegeps)
                {
                    if(cegep.Nom == ViewBag.NomCegep)
                    {
                        <option selected>@cegep.Nom</option>
                    }else{
                        <option>@cegep.Nom</option>
                    }
                }
        </select>
    </form>
    @*Affichage de la liste des cégeps...*@
    <br />
    <h3>Liste des département(s) (@ViewBag.ListeDepartement.Length Département(s)) :</h3>
    <br />
    <form asp-controller="" asp-action="" method="post">
        <table>
            <tr>
                <th>Numéro</th>
                <th>Nom</th>
                <th>Description</th>
                @if(ViewBag.ListeDepartement.Length > 0)
                {
                    <th><input value="Vider la Liste" onclick="document.getElementById('nomCegep').value ='@ViewBag.nomCegep';if(confirm('Voulez-vous vraiment vider la liste?')==true){this.form.action='/Departement/ViderListeDepartement'; this.form.method='post'; submit();}" type="button" /></th>
                }
        </tr>
        @foreach (DepartementDTO dep in ViewBag.ListeDepartement)
        {
            <tr>
                <td>@dep.No</td>
                <td>@dep.Nom</td>
                <td>@dep.Description</td>
                <td><input value="Modifier" onclick="document.getElementById('nomDepartement').value ='@dep.Nom';document.getElementById('nomCegep').value ='@ViewBag.nomCegep'; this.form.action='/Departement/FormulaireModifierDepartement'; this.form.method='get'; submit();" type="button" /></td>
                <td><input value="Supprimer" onclick="document.getElementById('nomDepartement').value ='@dep.Nom';document.getElementById('nomCegep').value ='@ViewBag.nomCegep'; if(confirm('Voulez-vous vraiment supprimer le Département?')==true){this.form.action='/Departement/SupprimerDepartement'; this.form.method='post'; submit();}" type="button" /></td>
              </tr>
        }
    </table>
    <input id="nomDepartement" name="nomDepartement" type="hidden"/>
    <input id="nomCegep" name="nomCegep" type="hidden"/>
</form>
    <br />
    <b>Ajouter un département : </b>
    <br />
    <br />
    <form asp-controller="Departement" asp-action="AjouterDepartement" method="post">
        <input type="hidden" name="nomCegep" value="@ViewBag.NomCegep"/>
        <table>
            <tr>
                <td>
                    <label asp-for="No"></label>
                </td>
                <td>
                    <input asp-for="No" />
                </td>
            </tr>
            <tr>
                <td>
                    <label asp-for="Nom"></label>
                </td>
                <td>
                    <input asp-for="Nom" />
                </td>
            </tr>
            <tr>
                <td>
                    <label asp-for="Description"></label>
                </td>
                <td>
                    <input asp-for="Description" />
                </td>
            </tr>
        </table>
        <input type="submit" value="Ajouter" />
    </form>
    <br/>
}
